Add ability to switch between implicit/explicit methods and semi-implicit methods.
Clean tests.
